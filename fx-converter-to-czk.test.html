<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Test Product Catalog</title>
  <style>
    body {
      font-family: sans-serif;
      margin: 2rem;
      line-height: 1.6;
    }
    .products-grid {
      display: flex;
      flex-wrap: wrap;
      gap: 2rem;
      justify-content: flex-start;
    }
    .product {
      border: 1px solid #ddd;
      padding: 1rem;
      margin-bottom: 1.5rem;
      flex: 1 1 calc(33.33% - 2rem); /* 3 columns, space for gap */
      box-sizing: border-box;
      max-width: calc(33.33% - 2rem);
      min-width: 250px;         /* optional: controls collapse on small screens */
    }
    .product img {
      width: 100%;
      max-width: 300px;
    }
    .price {
      font-weight: bold;
      color: darkgreen;
    }
  </style>
</head>
<body>
  <h1>Mock Product Catalog</h1>

  <div class="products-grid">
  <div class="product">
    <h2>Red Running Shoes</h2>
    <img src="https://placehold.co/300x200?text=Shoes" alt="Red Shoes">
    <p>High performance $90 running shoes with breathable mesh. Price: <span class="price">€89.99</span></p>
  </div>
  
  <div class="product">
    <h2>Leather Wallet</h2>
    <img src="https://placehold.co/300x200?text=Wallet" alt="Leather Wallet">
    <p>Compact wallet with RFID blocking. Only <span class="price">USD 45.00</span> while supplies last!</p>
  </div>

  <div class="product">
    <h2>Noise Cancelling Headphones</h2>
    <img src="https://placehold.co/300x200?text=Headphones" alt="Headphones">
    <p>Crystal clear audio and long battery life. Yours for <span class="price">$129.95</span>.</p>
  </div>

  <div class="product">
    <h2>Classic Backpack</h2>
    <img src="https://placehold.co/300x200?text=Backpack" alt="Backpack">
    <p>Durable and spacious. Price: <span class="price">199 GBP</span>.</p>
  </div>

  <div class="product">
    <h2>Desk Lamp</h2>
    <img src="https://placehold.co/300x200?text=Lamp" alt="Desk Lamp">
    <p>Minimalist LED lamp with touch dimmer. Just <span class="price">1,250.50 EUR</span>.</p>
  </div>

  <div class="product">
    <h2>Premium Office Chair</h2>
    <img src="https://placehold.co/300x200?text=Chair" alt="Office Chair">
    <p>Ergonomic design, could cost USD100 or USD200, adjustable height, and lumbar support. Price: <span class="price">€1,049.00 EUR</span></p>
  </div>

  </div>

  <hr>
  <p>All products above are examples for testing currency conversion scripts. Text and prices are fictional.</p>
  <div class="test-product">
    <span class="price">120 EUR</span>
  </div>

<script>
const priceRegex = new RegExp(
  [
    '(?:(?<code1>EUR|USD|GBP|DKK)\\s*(?<num1>-?\\d{1,3}(?:[.,\\s]?\\d{3})*(?:[.,]\\d+)?))',
    '(?:(?<num2>-?\\d{1,3}(?:[.,\\s]?\\d{3})*(?:[.,]\\d+)?)\\s*(?<code2>EUR|USD|GBP|DKK))',
    '(?:(?<sym>[\\$€£kr])\\s*(?<num3>-?\\d{1,3}(?:[.,\\s]?\\d{3})*(?:[.,]\\d+)?))'
  ].join('|'),
  'i'
);

function randomDigitExcept(original) {
  let digit;
  do {
    digit = Math.floor(Math.random() * 9) + 1;
  } while (digit == original);
  return digit;
}

function changeRandomDigitInPriceString(priceString) {
  const digitIndices = [];
  for (let i = 0; i < priceString.length; ++i) {
    if (/\d/.test(priceString[i])) {
      digitIndices.push(i);
    }
  }
  if (digitIndices.length === 0) return priceString;
  const randomIndex = digitIndices[Math.floor(Math.random() * digitIndices.length)];
  const oldDigit = priceString[randomIndex];
  const newDigit = randomDigitExcept(oldDigit);
  return priceString.slice(0, randomIndex) + newDigit + priceString.slice(randomIndex + 1);
}

setInterval(() => {
  const priceSpans = document.querySelectorAll('.price');
  if (priceSpans.length === 0) return;

  const randomSpan = priceSpans[Math.floor(Math.random() * priceSpans.length)];
  // Work on the full HTML for preservation of markup
  const origHtml = randomSpan.innerHTML;
  const match = origHtml.match(priceRegex);
  if (!match) return;

  const originalPrice = match[0];
  const newPrice = changeRandomDigitInPriceString(originalPrice);
  // Only replace the first occurrence! (in case there are multiple price matches)
  randomSpan.innerHTML = newPrice;

}, 3000);
</script>
</body>
</html>

